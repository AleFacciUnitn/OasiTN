{
  "create": "parchi",
  "validator": {
    "$jsonSchema": {
      "bsonType": "object",
      "required": [
        "nome",
        "location",
        "tags"
      ],
      "properties": {
        "nome": {
          "bsonType": "string",
          "description": "Il nome del parco è obbligatorio e deve essere una stringa."
        },
        "location": {
          "bsonType": "object",
          "required": [
            "lat",
            "long"
          ],
          "properties": {
            "lat": {
              "bsonType": "double",
              "description": "La latitudine è obbligatoria e deve essere un numero."
            },
            "long": {
              "bsonType": "double",
              "description": "La longitudine è obbligatoria e deve essere un numero."
            }
          },
          "description": "La posizione deve essere un oggetto con latitudine e longitudine."
        },
        "tags": {
          "bsonType": "array",
          "minItems": 1,
          "items": {
            "bsonType": "object",
            "required": [
              "tagId",
              "count",
              "positions"
            ],
            "properties": {
              "tagId": {
                "bsonType": "objectId",
                "description": "Il riferimento al tag è obbligatorio e deve essere un ObjectId."
              },
              "count": {
                "bsonType": "int",
                "minimum": 1,
                "description": "Il numero di oggetti per il tag deve essere almeno 1."
              },
              "positions": {
                "bsonType": "array",
                "minItems": 1,
                "items": {
                  "bsonType": "object",
                  "required": [
                    "lat",
                    "long"
                  ],
                  "properties": {
                    "lat": {
                      "bsonType": "double",
                      "description": "La latitudine della posizione è obbligatoria e deve essere un numero."
                    },
                    "long": {
                      "bsonType": "double",
                      "description": "La longitudine della posizione è obbligatoria e deve essere un numero."
                    }
                  },
                  "description": "Ogni posizione deve essere un oggetto con latitudine e longitudine."
                },
                "description": "Le posizioni devono essere un array di oggetti con latitudine e longitudine."
              }
            },
            "description": "Ogni tag deve avere un riferimento, un conteggio e un array di posizioni."
          },
          "description": "Tags deve essere un array contenente oggetti validi."
        },
        "infoParco": {
          "bsonType": "string",
          "description": "L'informazione del parco è opzionale ma, se presente, deve essere una stringa."
        }
      }
    }
  }
}